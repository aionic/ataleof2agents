{
  "openapi": "3.0.0",
  "info": {
    "title": "Weather Clothing Advisor Agent (Container Apps)",
    "description": "External agent running in Azure Container Apps. Provides weather-based clothing recommendations using workflow orchestration pattern.",
    "version": "1.0.0",
    "contact": {
      "name": "Weather Clothing Advisor Support"
    }
  },
  "servers": [
    {
      "url": "https://ca-weather-api-dev-ezbvua.mangomushroom-3560f614.swedencentral.azurecontainerapps.io",
      "description": "Azure Container Apps - Development"
    }
  ],
  "paths": {
    "/chat": {
      "post": {
        "summary": "Chat with external agent",
        "description": "Send a message to the Weather Clothing Advisor agent running in Container Apps. The agent will provide weather-based clothing recommendations.",
        "operationId": "chatWithExternalAgent",
        "tags": ["Agent"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChatRequest"
              },
              "example": {
                "message": "What should I wear in 10001?",
                "session_id": "optional-session-id"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Agent response with clothing recommendations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ChatResponse"
                },
                "example": {
                  "response": "Based on the current weather in New York (10001), which is 26Â°F with clear skies, I recommend wearing a heavy winter coat, thermal layers, warm hat, gloves, and insulated boots.",
                  "session_id": "abc-123-def-456",
                  "metadata": {
                    "workflow_id": "wf_123",
                    "workflow_duration": 2.45,
                    "steps_executed": 4
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "detail": "Invalid message format"
                }
              }
            }
          },
          "503": {
            "description": "Agent service unavailable",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "detail": "Services not available"
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "summary": "Health check",
        "description": "Check if the external agent service is healthy and available",
        "operationId": "healthCheck",
        "tags": ["Health"],
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "healthy"
                    },
                    "service": {
                      "type": "string",
                      "example": "weather-clothing-advisor"
                    },
                    "deployment": {
                      "type": "string",
                      "example": "container-app"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ChatRequest": {
        "type": "object",
        "required": ["message"],
        "properties": {
          "message": {
            "type": "string",
            "description": "User's message or question (e.g., 'What should I wear in 10001?')",
            "minLength": 1,
            "example": "What should I wear in 10001?"
          },
          "session_id": {
            "type": "string",
            "description": "Optional session identifier for conversation continuity",
            "example": "session-abc-123"
          }
        }
      },
      "ChatResponse": {
        "type": "object",
        "required": ["response", "session_id"],
        "properties": {
          "response": {
            "type": "string",
            "description": "Agent's response with clothing recommendations"
          },
          "session_id": {
            "type": "string",
            "description": "Session identifier for this conversation"
          },
          "metadata": {
            "type": "object",
            "description": "Optional workflow execution metadata",
            "properties": {
              "workflow_id": {
                "type": "string",
                "description": "Unique identifier for this workflow execution"
              },
              "workflow_duration": {
                "type": "number",
                "format": "float",
                "description": "Total workflow execution time in seconds"
              },
              "steps_executed": {
                "type": "integer",
                "description": "Number of workflow steps executed"
              }
            }
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "required": ["detail"],
        "properties": {
          "detail": {
            "type": "string",
            "description": "Error message describing what went wrong"
          }
        }
      }
    }
  },
  "security": []
}
